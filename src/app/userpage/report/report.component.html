@if(loading$ | async){
<div class="overlay"></div>
<p class="loading-text">
  報告產生中
  <p-progress-spinner strokeWidth="5" fill="transparent" animationDuration="1s"
    [style]="{ width: '70px', height: '70px' }" />
</p>
}
@if(showMessage){
<p-message severity="success" icon="pi pi-times-circle" styleClass="mb-2">儲存成功</p-message>
}

<div class="container">
  <div class="report-box">
    <div class="diet report">
      <h1>飲食</h1>
      @if(mealsList?.length > 0){
      @if(diet.breakfast.length > 0){
      <p>早餐吃了: {{diet.breakfast}}</p>
      }
      @if(diet.lunch.length > 0){
      <p>午餐吃了: {{diet.lunch}}</p>
      }
      @if(diet.dinner.length > 0){
      <p>晚餐吃了: {{diet.dinner}}</p>
      }
      }
      @else{
      <p>無資料</p>
      }
    </div>
    <div class="sleep report">
      <h1>睡眠</h1>
      @if(sleepList?.length > 0){
      <p>睡了 {{sleepList[0]?.hours}} 小時</p>
      }
      @else{
      <p>無資料</p>
      }
    </div>
    <div class="exercise report">
      <h1>運動</h1>
      @if(exerciseList?.length > 0){
      @for(exercise of exerciseList; track $index){
      <p>{{exercise.exerciseName}} - {{exercise.duration}} 分鐘</p>
      }
      <p>共消耗 {{totalConsumed}} 大卡</p>
      }
      @else{
      <p>無資料</p>
      }
    </div>
    <div class="ai report">
      <h1>報告與建議</h1>
      @if(report){
      <p>{{report}}</p>
      }
      @else{
      <p>無資料</p>
      }
    </div>
  </div>
  <div>
    <p-datepicker [(ngModel)]="selectedDate" [inline]="true" [showWeek]="false" (onSelect)="getData()"
      [maxDate]="today" />
    @if(mealsList?.length == 0 && sleepList?.length == 0 && exerciseList?.length == 0){
    <div class="card">
      <p-button class="report-btn" label="產生報告" icon="pi pi-check" iconPos="right" [disabled]="selectedDate < today" />
    </div>
    }
  </div>
  <p-speeddial [model]="items" [radius]="120" type="quarter-circle" direction="up-left"
    [style]="{ position: 'absolute', right: 0, bottom: 0 }" />
</div>

<p-dialog header="是否要產生報告" [modal]="true" [(visible)]="visible" [style]="{ width: '25rem' }">
  <div class="btn-area">
    <p-button label="取消" severity="danger" (click)="visible = false" />
    <p-button label="產生報告" />
  </div>
</p-dialog>
