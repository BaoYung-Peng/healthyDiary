@if(loading$ | async){
<div class="overlay">
  <h1 class="loading-text">
    報告產生中
  </h1>
  <p-progress-spinner strokeWidth="5" fill="transparent" animationDuration="1s"
    [style]="{ width: '70px', height: '70px' }" />
</div>
}
@if(showMessage){
<p-message severity="success" icon="pi pi-times-circle" styleClass="mb-2">儲存成功</p-message>
}

<<<<<<< HEAD
<div class="container">
  <div class="report-box">
    <div class="diet report">
      <h1>飲食紀錄</h1>
      @if(mealsList?.length > 0){
      @if(diet.breakfast.length > 0){
      <p>早餐吃了: {{diet.breakfast}}</p>
      }
      @if(diet.lunch.length > 0){
      <p>午餐吃了: {{diet.lunch}}</p>
      }
      @if(diet.dinner.length > 0){
      <p>晚餐吃了: {{diet.dinner}}</p>
      }
      }
      @else{
      <p>無資料</p>
      }
    </div>
    <div class="sleep report">
      <h1>睡眠紀錄</h1>
      @if(sleepList?.length > 0){
      <p>
        睡了 {{sleepList[0]?.hours}} 小時<br>
        {{sleepList[0]?.insomnia? '有' : '沒'}}失眠<br>
        睡前{{sleepList[0]?.phone? '有' : '沒'}}玩手機
      </p>
      }
      @else{
      <p>無資料</p>
      }
    </div>
    <div class="exercise report">
      <h1>運動紀錄</h1>
      @if(exerciseList?.length > 0){
      @for(exercise of exerciseList; track $index){
      <p>{{exercise.exerciseName}} - {{exercise.duration}} 分鐘</p>
      }
      <p>共消耗 {{totalConsumed}} 大卡</p>
      }
      @else{
      <p>無資料</p>
      }
    </div>
    <div class="ai report">
      <h1>報告與建議</h1>
      @if(report){
      <p>{{report}}</p>
      }
      @else{
      @if(isToday){
      <div style="display: flex; justify-content: center;">
        <p-button class="report-btn" label="產生報告" icon="pi pi-check" iconPos="right" (click)="visible = true" />
      </div>
      }
      @else {
      <p>無資料</p>
      }
      }
    </div>
  </div>
  <div>
    <p-datepicker [(ngModel)]="selectedDate" [inline]="true" [showWeek]="false" (onSelect)="getData()"
      [maxDate]="today" />
  </div>
=======
<h1>當週報告</h1>
<div class="week-buttons">
  @for(day of weekDays; track $index){
  <button (click)="selectDay($index)"
    [ngClass]="{'today-button': isToday($index), 'selected-button': selectedDateIndex === day.value}"
    [disabled]="isFutureDate(day.value)">
    {{day.label}}
  </button>
  }
>>>>>>> 81c1efe0c27e47f91e8885e801daa96ab87911e2
</div>

@if(selectedDayReport && !(aiRes)){
<div class="report-container">
  <div class="daily-report">
    <p class="summary">{{summary}}</p>
  </div>
  <div class="ai-report">
    <p class="summary">{{selectedDayReport.feedback}}</p>
  </div>
  <div class="score-report">
    <img class="chat" src="imgs/chat.svg" />
    <span>持續讓自己變得更好!!</span>
    <img class="cat" src="imgs/playful-cat.svg" />
  </div>
</div>
}

@if(!(aiRes) && !(selectedDayReport)){
<div class="card">
  <h2>還沒有產生報告</h2>
  <p-button class="report-btn" (click)="showDialog()" label="產生報告" icon="pi pi-check" iconPos="right" />
</div>
}
@if(aiRes){
<div class="report-container">
  <div class="daily-report">
    <p class="summary">{{summary}}</p>
  </div>
  <div class="ai-report">
    <p class="summary">{{aiRes}}</p>
  </div>
  <div class="score-report">
    <img class="chat" src="imgs/chat.svg" />
    <span>今天的紀錄已完成，明天再來吧</span>
    <img class="cat" src="imgs/playful-cat.svg" />
  </div>
</div>
}

<p-dialog header="是否要產生報告" [modal]="true" [(visible)]="visible" [style]="{ width: '25rem' }">
  <div class="btn-area">
    <p-button label="取消" severity="danger" (click)="visible = false" />
<<<<<<< HEAD
    <p-button label="產生報告" (click)="generateReport()" />
=======
    <p-button label="產生報告" (click)="confirm()" />
>>>>>>> 81c1efe0c27e47f91e8885e801daa96ab87911e2
  </div>
</p-dialog>
